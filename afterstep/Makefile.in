@MAKEFILECOMMON@

#CREATE_SHAREDIR_LIST= desktop backgrounds

IMAGE_DIR_LIST= backgrounds backgrounds/Plain_Textures \
				desktop/bars desktop/buttons desktop/icons \
				desktop/icons/dots desktop/icons/large desktop/icons/logos \
				desktop/icons/mini desktop/icons/normal desktop/tiles

MISC_FILES_DIR_LIST= desktop/cursors desktop/fonts desktop/sounds

CONFIG_DIR_LIST= feels colorschemes looks scripts themes start


install:
	@if [ -d $(AFTER_SHAREDIR) ] ; then \
	  echo $(RMF) -r $(AFTER_SHAREDIR)_old; \
	  echo $(MV) $(AFTER_SHAREDIR) $(AFTER_SHAREDIR)_old; \
	  $(RMF) -r $(AFTER_SHAREDIR)_old; \
	  $(MV) $(AFTER_SHAREDIR) $(AFTER_SHAREDIR)_old; \
	fi; \
	$(MKDIR) -p $(AFTER_SHAREDIR); \
	$(MKDIR) -p $(AFTER_DOC_DIR) ; \
	$(MKDIR) -p $(AFTER_SHAREDIR)/desktop
	@for D in ${IMAGE_DIR_LIST}; do \
		$(MKDIR) -p $(AFTER_SHAREDIR)/$$D; \
		if [ -d $$D/xml ] ; then \
			echo "$(CP) $$D/xml/* $(AFTER_SHAREDIR)/$$D/"; \
			for I in $$D/xml/* $$D/xml/.*; do \
			  if [ -f $$I ] ; then \
			    $(CP) $$I $(AFTER_SHAREDIR)/$$D/; \
			  fi; \
			done ; \
		fi; \
		if [ -d $$D/$(IMAGE_FORMAT) ] ; then \
			echo "$(CP) $$D/$(IMAGE_FORMAT)/* $(AFTER_SHAREDIR)/$$D/"; \
			for I in $$D/$(IMAGE_FORMAT)/* $$D/$(IMAGE_FORMAT)/.*; do \
			  if [ -f $$I ] ; then \
			    $(CP) $$I $(AFTER_SHAREDIR)/$$D/; \
			  fi; \
			done ; \
		fi; \
		if [ -r $$D/jpg ] ; then \
			echo "$(CP) $$D/jpg/* $(AFTER_SHAREDIR)/$$D/"; \
			for I in $$D/jpg/* $$D/jpg/.*; do \
			  if [ -f $$I ] ; then \
			    $(CP) $$I $(AFTER_SHAREDIR)/$$D/; \
			  fi; \
			done ; \
		fi; \
	done ; \
	$(CP) desktop/icons/CREDITS $(AFTER_SHAREDIR)/desktop/icons/
	@for D in ${MISC_FILES_DIR_LIST}; do \
		echo "$(MKDIR) -p $(AFTER_SHAREDIR)/$$D"; \
		$(MKDIR) -p $(AFTER_SHAREDIR)/$$D; \
		echo "$(CP) -r $$D/* $(AFTER_SHAREDIR)/$$D/"; \
		$(CP) -r $$D/* $(AFTER_SHAREDIR)/$$D/; \
	done
	@for D in ${CONFIG_DIR_LIST}; do \
		echo "$(MKDIR) -p $(AFTER_SHAREDIR)/$$D"; \
		$(MKDIR) -p $(AFTER_SHAREDIR)/$$D; \
		echo "$(CP) -r $$D/* $(AFTER_SHAREDIR)/$$D/"; \
		$(CP) -r $$D/* $(AFTER_SHAREDIR)/$$D/; \
	done
	@$(RMF) $(AFTER_SHAREDIR)/start/.include.in; \
	$(CP) start/.include $(AFTER_SHAREDIR)/start/.include; \
	$(RMF) $(AFTER_SHAREDIR)/start/Desktop/Feel/.include.in; \
	$(RMF) $(AFTER_SHAREDIR)/start/Desktop/Color_Scheme/.include.in; \
	$(RMF) $(AFTER_SHAREDIR)/start/Desktop/Look/.include.in; \
	$(RMF) $(AFTER_SHAREDIR)/start/Desktop/Theme/.include.in; \
	$(RMF) $(AFTER_SHAREDIR)/start/Desktop/Pictures/.include.in
	@$(MKDIR) -p $(AFTER_SHAREDIR)/non-configurable; \
	$(CP) -r non-configurable $(AFTER_SHAREDIR)/; \
	$(RMF) $(AFTER_SHAREDIR)/non-configurable/*.in
	$(FIND) $(AFTER_SHAREDIR) -name '*.in' -print | $(XARGS) $(RMF) -r
	$(FIND) $(AFTER_SHAREDIR) -name '*.orig' -print | $(XARGS) $(RMF) -r
	$(FIND) $(AFTER_SHAREDIR) -name CVS -print | $(XARGS) $(RMF) -r
	$(FIND) $(AFTER_SHAREDIR) -name .cvsignore -print | $(XARGS) $(RMF)
	$(CP) autoexec banner base database pager wharf winlist $(AFTER_SHAREDIR)

uninstall:
	$(RMF) -r $(AFTER_SHAREDIR)
	@if [ -d $(AFTER_SHAREDIR)_old ] ; then \
	  echo $(MV) $(AFTER_SHAREDIR)_old $(AFTER_SHAREDIR); \
	  $(MV) $(AFTER_SHAREDIR)_old $(AFTER_SHAREDIR); \
	fi


